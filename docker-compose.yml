services:
  provisioner:
    build: .
    volumes:
      - .:/infra-config:ro
      # The output directory is mounted as rw so that the provisioner can write
      # to it.
      - ./outputs:/infra-config/outputs:rw
    tmpfs:
      - /run:exec
      - /tmp:exec
    working_dir: /infra-config
    # init handles singal forwarding so the container can be stopped gracefully.
    init: true
    environment:
      DRY_RUN: ${DRY_RUN:-}
      PYTHONPATH: /infra-config
